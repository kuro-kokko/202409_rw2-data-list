# rw2-data-list

<https://kuro-kokko.github.io/202409_rw2-data-list/>

このリポジトリは 2024 上期課題の 3 作目です。  
※着手時期は 2 作目よりも先ですが、完成はこちらの方が遅かったので 3 作目として扱います。

## 作成経緯

[Rift Wizard 2](https://store.steampowered.com/app/2058570/Rift_Wizard_2/)という PC 向けゲームのスキルデータをオフラインで参照するため作成。  
ゲーム内では大量の Spell 等のデータが存在するが、それらの一覧からテキスト検索が出来ないためやや不便だった。  
今回はそれらの問題を解消するための機能を実装した。

## 開発環境・使用技術

### 言語・ライブラリ

#### アプリ本体

- Vue.js
- Bootstrap
- FontAwesome (ダークモード切替トグルのアイコン)

#### データ作成用スクリプト

- Python
  - PIL (画像処理)
  - pytesseract (OCR)
- Google Apps Script (最終加工・json 出力)

### ツール類

- Visual Studio Code
- Google スプレッドシート
- Tesseract OCR (OCR エンジン)
- Claude 3.5 Sonnet (生成 AI・開発補助)

## 実装内容

- ゲーム内データ(Skill, Upgrades, Spell)の一覧表示機能
- 検索・抽出機能
  - 名称や説明文のテキストに対する検索機能
  - Type による絞り込み機能
  - Upgrades(子スキル)を検索に含む/含めないの切替機能
- ダークモード切替機能

### 工夫した点

- 大量のデータを扱っても動作が軽量になるようにした
  - データも DB を使用せずオブジェクトの配列にした
- テキストが読みやすいカードデザインにした
  - Type は Bootstrap の `badge` をカスタムし色で判別出来るようにした
- 1 作目(camel-snake-converter)の反省を活かし、ユーザビリティを重視した
  - 入力クリアボタン、ダークモード等
  - Chrome ブラウザの翻訳機能使用時、カードタイトル部分の名称等が日本語訳されないようにした
    - 説明テキストのみ日本語で参照出来るようにするため。名称が日本語になってしまうとゲーム内表示と比較しづらい
- データは手打ちではなくスクリーンショットから抽出した
  - データ量が多いため、OCR スクリプトを別途作成し下記手順で作成した
    1. 読み取り範囲のトリミング、不要箇所のマスキング処理
    1. OCR で読み取り csv で出力
    1. 目視確認 (フォントの問題で数値の読み取りが苦手だったので、その辺りを中心にチェック)
    1. Google スプレッドシートに 3.をコピペ
    1. Google Apps Script のスクリプトでデータを加工し json で出力

### 悪い点

- 下にスクロールした場合、1回の操作で画面最上部に戻る手段がない
  - キーボード操作の場合は `Ctrl+Home` で戻れるがマウスホイールやタップスクロールの場合は操作性が悪い
- 一部の Type 検索用トグルの色が見辛い
  - ゲーム内で表示されている色に近い配色にしていた
    - ナイト、ダークモード両方で見やすい配色に調整するべきだった
- 検索機能を保持する機能がない
  - 検索条件をテキストで出力する機能があればより使いやすい？

## 総括

- 1 作目の反省を踏まえた実装を行うことが出来た。
  - ~~8月末にゲームのアップデートが行われ、全てのSpellに情報が追加されたためデータ修正が大変だった~~
- データの抽出には自作した OCR を使用し、こちらでも多くの知見を得ることが出来た。
  - ゲームで使用されているフォントを学習させて読み取り精度を上げることも考えたが、最終的に目視チェックは必須になるので今回は試さなかった。
    - こちらは別の機会に試してみたい。
